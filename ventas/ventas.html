<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Perfect Launch</title>
    <link rel="stylesheet" href="ventas.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="Main.js" defer></script>
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link href='//fonts.googleapis.com/css?family=Montserrat:thin,extra-light,light,100,200,300,400,500,600,700,800' rel='stylesheet' type='text/css'>
    <style>
        body {
            font-family: 'Montserrat';
        }
    </style>
</head>
<body>
  <div class="sidebar close">
    <div class="logo-details">
      <i class='bx bxl-c-plus-plus'></i>
      <span class="logo_name">Dashboard</span>
    </div>
    <ul class="nav-links">
      <li>
        <a href="../Index.html">
          <i class='bx bx-grid-alt' ></i>
          <span class="link_name">Dashboard</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Dashboard</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-collection' ></i>
            <span class="link_name">Comparativa</span>
          </a>
          <i class='bx bxs-chevron-down arrow' ></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Lanzamientos</a></li>
          <li><a href="#" >Enero</a></li>
          <li><a href="#" >Abril</a></li>
          <li><a href="#" >Julio</a></li>
          <li><a href="#" >Septiembre</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="#">
            <i class='bx bx-book-alt' ></i>
            <span class="link_name">Posts</span>
          </a>
          <i class='bx bxs-chevron-down arrow' ></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Posts</a></li>
          <li><a href="#">Web Design</a></li>
          <li><a href="#">Login Form</a></li>
          <li><a href="#">Card Design</a></li>
        </ul>
      </li>
      <li>
        <a href="../ventas/ventas.html">
          <i class='bx bx-pie-chart-alt-2' ></i>
          <span class="link_name">Lanzamientos</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Analytics</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-line-chart' ></i>
          <span class="link_name">Chart</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Chart</a></li>
        </ul>
      </li>
      <li>
        <div class="iocn-link">
          <a href="ventas/ventas.html">
            <i class='bx bx-collection' ></i>
            <span class="link_name">Lanzamientos</span>
          </a>
          <i class='bx bxs-chevron-down arrow' ></i>
        </div>
        <ul class="sub-menu">
          <li><a class="link_name" href="#">Lanzamientos</a></li>
          <li><a href="#">Enero</a></li>
          <li><a href="#">Abril</a></li>
          <li><a href="#">Julio</a></li>
          <li><a href="../Index.html">Septiembre</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-compass' ></i>
          <span class="link_name">Explore</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Explore</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-history'></i>
          <span class="link_name">History</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">History</a></li>
        </ul>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-cog' ></i>
          <span class="link_name">Setting</span>
        </a>
        <ul class="sub-menu blank">
          <li><a class="link_name" href="#">Setting</a></li>
        </ul>
      </li>
      <li>
    <div class="profile-details">
      <div class="profile-content">
        <!--<img src="image/profile.jpg" alt="profileImg">-->
      </div>
      <div class="name-job">
        <div class="profile_name">Prem Shahi</div>
        <div class="job">Web Desginer</div>
      </div>
      <i class='bx bx-log-out' ></i>
    </div>
  </li>
</ul>
  </div>
  <section class="home-section">
    <div class="home-content">
        <i class='bx bx-menu'></i>
        <img src="logo.png" alt="Logo"><!-- Agregar texto relevante -->
    </div>
</section>

<div class="contenedor-principal">
  <!-- Fila superior con 4 contenedores -->
  <div class="fila-superior2">
      <div id="enero" class="contenedor-pequeño2">
              <div class="statnum2">ENERO</div>
      </div>
      <div id="abril" class="contenedor-pequeño2">
              <div class="statnum2">ABRIL</div>
      </div>
      <div id="julio" class="contenedor-pequeño2">
              <div class="statnum2">JULIO</div>
      </div>
      <div id="septiembre" class="contenedor-pequeño2">
              <div class="statnum2">SEPT</div>
      </div>
  </div>


  <div class="contenedor-centro">
      <div class="canva1" id="barChart" ></div>
      <div class="canva2" id="lineChart" ></div>

</div>

<div id="salesTables"></div>




    <!-- <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <script src="https://kit.fontawesome.com/e267099c50.js" crossorigin="anonymous"></script>

    <script>
        let arrow = document.querySelectorAll(".arrow");
        arrow.forEach((arrowElement) => {
            arrowElement.addEventListener("click", (e) => {
                let arrowParent = e.target.parentElement.parentElement; // selecciona el padre principal de la flecha
                arrowParent.classList.toggle("showMenu");
            });
        });

        let sidebar = document.querySelector(".sidebar");
        let sidebarBtn = document.querySelector(".bx-menu");
        sidebarBtn.addEventListener("click", () => {
            sidebar.classList.toggle("close");
        });

document.addEventListener('DOMContentLoaded', function () { 
    const url = 'https://script.google.com/macros/s/AKfycbyEKcO_o0uHWrjTDx33whPQ3xP_-CKgLuAWeIBIRMlKRQQCq6aiR0GmNVuoaydwRf0MQQ/exec';

    async function fetchData() {
        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Error en la solicitud: ' + response.statusText);
            }
            const data = await response.json();
            console.log('Datos obtenidos:', data);
            createCharts(data.graficas);
            createTables(data.tabla); // Llamar a la función para crear las tablas
        } catch (error) {
            console.error('Error al obtener los datos:', error);
        }
    }

    function createCharts(combinedValues) {
        const eneroSales = combinedValues.map(row => row[1]);
        const abrilSales = combinedValues.map(row => row[2]);
        const julioSales = combinedValues.map(row => row[3]);
        const septiembreSales = combinedValues.map(row => row[4]);

        const barTotals = [
            eneroSales.reduce((sum, val) => sum + val, 0),
            abrilSales.reduce((sum, val) => sum + val, 0),
            julioSales.reduce((sum, val) => sum + val, 0),
            septiembreSales.reduce((sum, val) => sum + val, 0)
        ];

        // Inicializar gráfico de barras
        const barChart = echarts.init(document.getElementById('barChart'));
        const barOption = {
            tooltip: {},
            xAxis: {
                type: 'category',
                data: ['ENERO', 'ABRIL', 'JULIO', 'SEPTIEMBRE'],
                axisLabel: { color: 'white', fontSize: 17 }
            },
            yAxis: {
                type: 'value',
                axisLabel: { color: 'white', fontSize: 20 },
                splitLine: { lineStyle: { color: 'rgb(10, 52, 94)' } }
            },
            series: [{
                name: 'Ventas',
                type: 'bar',
                data: barTotals,
                itemStyle: {
                    color: function (params) {
                        const colors = ['#EEB84C', '#D474C7', '#13C3E9', '#90EE90'];
                        return colors[params.dataIndex];
                    },
                    borderRadius: [10, 10, 0, 0],
                    shadowBlur: 10,
                    shadowColor: 'rgba(0, 0, 0, 0.8)',
                    shadowOffsetX: 5,
                    shadowOffsetY: 5,
                },
                label: {
                    show: true,
                    position: 'top',
                    color: '#ffffff',
                    fontSize: 16,
                    fontWeight: 'bold',
                    textShadowColor: '#000',
                    textShadowBlur: 5
                },
                barWidth: 50,
                animationDelay: function (idx) {
                    return idx * 200;
                }
            }],
            animationEasing: 'elasticOut',
            animationDuration: 2000
        };
        barChart.setOption(barOption);

        // Inicializar gráfico lineal
        const lineChart = echarts.init(document.getElementById('lineChart'));
        const lineOption = {
            tooltip: { trigger: 'axis' },
            legend: {
                data: ['Enero', 'Abril', 'Julio', 'Septiembre'],
                textStyle: { color: 'white' }
            },
            xAxis: {
                type: 'category',
                data: combinedValues.map(row => row[0]),
                axisLabel: { color: 'white', fontSize: 17 }
            },
            yAxis: {
                type: 'value',
                axisLabel: { color: 'white', fontSize: 17 },
                splitLine: { lineStyle: { color: 'rgb(10, 52, 94)' } }
            },
            series: [
                { 
                    name: 'Enero', 
                    type: 'line', 
                    data: eneroSales, 
                    lineStyle: { color: '#EEB84C', width: 4 }, 
                    itemStyle: { color: '#EEB84C' }
                },
                { 
                    name: 'Abril', 
                    type: 'line', 
                    data: abrilSales, 
                    lineStyle: { color: '#D474C7', width: 4 }, 
                    itemStyle: { color: '#D474C7' }
                },
                { 
                    name: 'Julio', 
                    type: 'line', 
                    data: julioSales, 
                    lineStyle: { color: '#13C3E9', width: 4 }, 
                    itemStyle: { color: '#13C3E9' }
                },
                { 
                    name: 'Septiembre', 
                    type: 'line', 
                    data: septiembreSales, 
                    lineStyle: { color: '#90EE90', width: 4 }, 
                    itemStyle: { color: '#90EE90' }
                }
            ],
            animationEasing: 'elasticOut',
            animationDuration: 1500
        };
        lineChart.setOption(lineOption);

        // Variable para mantener el estado de resaltado
        let highlightedIndex = -1;

        // Función para actualizar gráficos
        function highlightMonth(index) {
            const colors = ['#EEB84C', '#D474C7', '#13C3E9', '#90EE90'];
            const fadedColor = 'rgba(28,59,137,0.5)';

            if (highlightedIndex === index) {
                // Si el índice ya está resaltado, restaurar colores originales
                highlightedIndex = -1; // Restablecer el índice resaltado
                barOption.series[0].itemStyle.color = function (params) {
                    return colors[params.dataIndex]; // Color original
                };
                lineOption.series.forEach((serie, i) => {
                    serie.lineStyle.color = colors[i]; // Color original
                });
            } else {
                // Resaltar el mes correspondiente
                highlightedIndex = index; // Actualizar el índice resaltado
                barOption.series[0].itemStyle.color = function (params) {
                    return params.dataIndex === index ? colors[params.dataIndex] : fadedColor;
                };
                lineOption.series.forEach((serie, i) => {
                    serie.lineStyle.color = i === index ? colors[i] : fadedColor;
                });
            }
            barChart.setOption(barOption);
            lineChart.setOption(lineOption);
        }

        // Agregar eventos de click a los contenedores de los meses
        document.getElementById('enero').addEventListener('click', function () {
            highlightMonth(0);
        });
        document.getElementById('abril').addEventListener('click', function () {
            highlightMonth(1);
        });
        document.getElementById('julio').addEventListener('click', function () {
            highlightMonth(2);
        });
        document.getElementById('septiembre').addEventListener('click', function () {
            highlightMonth(3);
        });
    }
    function createTables(data) {
    const tableContainer = document.getElementById('salesTables');
    tableContainer.innerHTML = ''; // Limpiar contenido anterior

    // Datos para cada mes
    const months = ['ENERO', 'ABRIL', 'JULIO', 'SEPTIEMBRE'];
    
    // Acceso correcto a los datos
    const salesData = [
        data.map(row => [row[0], row[1]]), // Enero
        data.map(row => [row[0], row[2]]), // Abril
        data.map(row => [row[0], row[3]]), // Julio
        data.map(row => [row[0], row[4]])  // Septiembre
    ];

    months.forEach((month, index) => {
        const table = document.createElement('table');
        table.className = 'sales-table';

        const header = document.createElement('tr');
        const headerCell1 = document.createElement('th');
        headerCell1.textContent = month; // Cambiar "Tipo de Pago" por el nombre del mes
        const headerCell2 = document.createElement('th');
        headerCell2.textContent = 'TOTAL';

        header.appendChild(headerCell1);
        header.appendChild(headerCell2);
        table.appendChild(header);

        salesData[index].forEach(row => {
            const tr = document.createElement('tr');
            const td1 = document.createElement('td');
            td1.textContent = row[0] || 'Sin datos'; // Tipo de pago
            const td2 = document.createElement('td');
            td2.textContent = row[1] || 0; // Total

            tr.appendChild(td1);
            tr.appendChild(td2);
            table.appendChild(tr);
        });

        const monthHeader = document.createElement('h3');
        // monthHeader.textContent = month;
        tableContainer.appendChild(monthHeader);
        tableContainer.appendChild(table);
    });
}




      fetchData();
});


    </script>
</body>
</html>
